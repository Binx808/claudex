# Preset: Python + FastAPI
name: python-fastapi
description: Python backend with FastAPI, SQLAlchemy, PostgreSQL, Redis

src_dir: src
backend_framework: FastAPI

architecture_tree: |
  ├── src/
  │   ├── api/             # FastAPI endpoints
  │   ├── core/            # Business logic (pure, no I/O)
  │   ├── db/              # SQLAlchemy models, migrations, repositories
  │   └── worker/          # Background tasks, schedulers

layer_description: |
  - **Core**: Pure business logic, no framework imports
  - **DB**: SQLAlchemy ORM, Alembic migrations, repositories
  - **API**: FastAPI REST endpoints, request validation
  - **Worker**: Background tasks, data processing pipelines

layer_rules:
  "src/core/":
    forbidden_imports:
      - sqlalchemy
      - redis
      - httpx
      - requests
      - fastapi
      - uvicorn
      - alembic
    file_blocks:
      - llm
      - openai
      - anthropic
  "src/db/":
    no_import_from:
      - "from src.worker"
      - "from src.api"
  "src/worker/":
    no_import_from:
      - "from src.api"

lint_dirs:
  - src/
  - tests/

lint_extensions:
  - .py

quick_start: |
  poetry install
  docker-compose up -d
  alembic upgrade head
  uvicorn src.api.main:app --reload

test_command: "poetry run pytest tests/ -v --tb=short"
lint_command: "ruff check src/ tests/ && ruff format src/ tests/ --check"
